# PCD_MATLAB_Tools

This Guide/Set of simple tools helps you convert PointCloud2 data in ROS bags to mat files in MATLAB. The tools in this repository were designed for a Velodyne VLP-16, saved bag files from other LIDAR models may not work. 


## Prerequisites

1. PCL, PCL-Tools http://pointclouds.org/downloads/linux.html , https://packages.ubuntu.com/xenial/libs/pcl-tools
2. pcl_ros http://wiki.ros.org/pcl_ros
3. MATLAB R2017a - older versions may work.

## Usage

First convert your bag file to PCD files using pcl_ros.

`> rosrun pcl_ros bag_to_pcd <bagfile.bag> <topicname> <output directory>`

Next move `loadpcd.m` `pcd2mat.m` and `pcdbinaryascii.sh` to the output directory.

Give `pcdbinaryascii.sh` executable permissions if it does not have any

`> chmod +x pcdbinaryascii.sh`

Run *pcdbinaryascii.sh*

`> ./pcdbinaryascii.sh`

This will convert the PCD files generated by pcl_ros into ASCII readable files. Old binary PCD files are renamed with .old suffix.

Run the MATLAB script `pcd2mat.m`. All PCD files will then be converted into mat files with a variable of `data` holding the PCD data.

## Bugs

MATLAB will not sequentially convert the PCD file to mat files. Thus 1.pcd may not correspond to 1.mat.
